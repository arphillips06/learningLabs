#
# Module devmgr configuration.
#
configure snmp sysName "TOR2"
configure sys-recovery-level switch reset

#
# Module vlan configuration.
#
configure vlan default delete ports all
configure vr VR-Default delete ports 1-5
configure vr VR-Default add ports 1-5
create qosprofile "QP2"
create qosprofile "QP3"
create qosprofile "QP4"
create qosprofile "QP5"
create qosprofile "QP6"
create qosprofile "QP7"
create vlan "LOOPBACK"
enable loopback-mode vlan LOOPBACK
create vlan "P2P-TOR2-AS8"
create vlan "P2P-TOR2-CS1"
create vlan "P2P-TOR2-CS2"
configure vlan Default add ports 4-5 untagged
configure vlan P2P-TOR2-AS8 add ports 1 untagged
configure vlan P2P-TOR2-CS1 add ports 3 untagged
configure vlan P2P-TOR2-CS2 add ports 2 untagged
configure vlan LOOPBACK ipaddress 10.255.0.12 255.255.255.255
enable ipforwarding vlan LOOPBACK
configure vlan P2P-TOR2-AS8 ipaddress 172.16.3.0 255.255.255.254
enable ipforwarding vlan P2P-TOR2-AS8
configure vlan P2P-TOR2-CS1 ipaddress 172.16.1.3 255.255.255.254
enable ipforwarding vlan P2P-TOR2-CS1
configure vlan P2P-TOR2-CS2 ipaddress 172.16.2.3 255.255.255.254
enable ipforwarding vlan P2P-TOR2-CS2
configure vlan LOOPBACK ipaddress eui64 fe80::/64
configure vlan LOOPBACK ipaddress 2a0b::12/128
configure qosscheduler strict-priority ports 1
configure qosscheduler strict-priority ports 2
configure qosscheduler strict-priority ports 3
configure qosscheduler strict-priority ports 4
configure qosscheduler strict-priority ports 5

#
# Module mcmgr configuration.
#
enable ipmcforwarding vlan "LOOPBACK"
enable ipmcforwarding vlan "P2P-TOR2-AS8"
enable ipmcforwarding vlan "P2P-TOR2-CS1"
enable ipmcforwarding vlan "P2P-TOR2-CS2"

#
# Module fdb configuration.
#
disable iparp vr VR-Mgmt refresh
disable neighbor-discovery vr VR-Mgmt refresh

#
# Module policy configuration.
#
configure policy slices tci-overwrite 0
enable policy

#
# Module ospf configuration.
#
configure ospf routerid 10.255.0.12
configure ospf metric-table 10M 10 100M 5 1G 4 2.5G 3 5G 3 10G 3 25G 2 40G 2 50G 2 100G 1
enable ospf
configure ospf add vlan LOOPBACK area 0.0.0.0 passive
configure ospf add vlan P2P-TOR2-AS8 area 0.0.0.0 link-type point-to-point
configure ospf add vlan P2P-TOR2-CS1 area 0.0.0.0 link-type point-to-point
configure ospf add vlan P2P-TOR2-CS2 area 0.0.0.0 link-type point-to-point

#
# Module pim configuration.
#
configure pim add vlan "P2P-TOR2-CS1" sparse
configure pim add vlan "P2P-TOR2-CS2" sparse
configure pim add vlan "P2P-TOR2-AS8" sparse
enable pim
configure pim crp static 192.168.10.1 "v4-groups" 192
